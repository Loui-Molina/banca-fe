<div class="fit-height mb-20" style="min-height: 300px;">
  <app-abm [columns]="columns"
           [defaultForm]="defaultForm"
           [fetcherCreate]="fetcherCreate"
           [fetcherDelete]="fetcherDelete"
           [fetcherUpdate]="fetcherUpdate"
           [fetcher]="fetcher"
           [formTemplate]="formTemplate"
           [form]="formABM"
           [getValidators]="getValidators"
           [parseData]="parseData"
           [title]="'CONSORTIUMS.TITLE'"
           [viewTemplate]="viewTemplate">
  </app-abm>


  <ng-template #formTemplate let-mode let-visibleObject="visibleObject">
    <form [formGroup]="formABM">

      <nz-divider [nzText]="'CONSORTIUMS.CREATE.CONSORTIUM_DATA'|translate" class="title" nzOrientation="left"
                  style="margin-top: 0"></nz-divider>

      <div class="form-element">
        <label for="name">
          {{'CONSORTIUMS.CREATE.NAME'|translate}}
        </label>
        <input formControlName="name" id="name" nz-input type="text">
      </div>

      <div class="form-element">
        <label for="status">
          {{'CONSORTIUMS.CREATE.STATUS'|translate}}
        </label>
        <nz-switch formControlName="status" id="status" style="padding-left: 10px"></nz-switch>
      </div>

      <nz-divider [nzText]="'CONSORTIUMS.CREATE.USER_DATA'|translate" class="title" nzOrientation="left"></nz-divider>

      <div class="form-element">
        <label for="ownerName">
          {{'CONSORTIUMS.CREATE.OWNER_NAME'|translate}}
        </label>
        <input formControlName="ownerName" id="ownerName" nz-input type="text">
      </div>


      <div>
        <label for="ownerUsername">
          {{'CONSORTIUMS.CREATE.USERNAME'|translate}}
        </label>
        <input [minLength]="4" formControlName="ownerUsername" id="ownerUsername" nz-input type="text">
      </div>

      <div  *ngIf="mode === 'C'">
        <label for="password">
          {{'CONSORTIUMS.CREATE.PASSWORD'|translate}}
        </label>
        <input [maxLength]="35" [minLength]="8" formControlName="password" id="password" nz-input type="text">
      </div>

      <ng-container *ngIf="mode === 'U'">
        <p class="button-link" (click)="changePassword(visibleObject.ownerId)">{{'CONSORTIUMS.CREATE.CHANGE_PASSWORD'|translate}}</p>
      </ng-container>

    </form>
  </ng-template>

  <ng-template #viewTemplate let-visibleObject>
    <ng-container *ngIf="visibleObject">
      <nz-divider [nzText]="'CONSORTIUMS.VIEW.CONSORTIUM'|translate" class="title" nzOrientation="left"></nz-divider>
      <nz-descriptions>
        <nz-descriptions-item [nzTitle]="'CONSORTIUMS.VIEW.NAME'|translate">
          {{visibleObject.name}}
        </nz-descriptions-item>
        <nz-descriptions-item [nzTitle]="'CONSORTIUMS.VIEW.USERNAME'|translate">
          {{visibleObject.ownerUsername}}
        </nz-descriptions-item>
        <nz-descriptions-item
          [nzTitle]="'CONSORTIUMS.VIEW.STATUS'|translate">{{visibleObject.status ?
          ('CONSORTIUMS.VIEW.ENABLED'|translate) :
          ('CONSORTIUMS.VIEW.DISABLED'|translate)}}</nz-descriptions-item>
      </nz-descriptions>

      <nz-divider [nzText]="'CONSORTIUMS.VIEW.BANKINGS'|translate" class="title" nzOrientation="left"></nz-divider>

      <nz-table [nzData]="visibleObject.bankings"
                [nzNoResult]="'UTILS.NO_RESULTS'|translate"
                [nzSize]="'small'"
                nzLoading="false"
                nzTableLayout="auto"
                style="margin-top: 20px">
        <thead>
        <tr>
          <th *ngFor="let column of columnsBanking">
            {{column.title|translate}}
          </th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let data of visibleObject.bankings">
          <td>{{ data.name }}</td>
        </tr>
        </tbody>
      </nz-table>
    </ng-container>
  </ng-template>

</div>
