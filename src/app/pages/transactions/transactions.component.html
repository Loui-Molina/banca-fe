<app-page-loader-bouncing [loading]="loading"></app-page-loader-bouncing>
<div class="inner-content mb-20">
  <div class="inner-content fit-height mb-20" style="min-height: 300px;">
    <div style="display: flex; justify-content: space-between; margin-bottom: 20px">
      <app-title-divider title="{{'Ultimas transacciones' |translate}}"></app-title-divider>
      <button nz-button (click)="openDrawer('drawerTransaction')"
              *ngIf="user?.role === userRole.Admin || user?.role === userRole.Consortium">
        {{'Crear transaccion'|translate}}
      </button>
    </div>

    <nz-table [nzScroll]="{ x: '1250px' }" #basicTable [nzData]="transactions">
      <thead>
      <tr>
        <th class="table-th" [class.numeric]="column.type === 'numeric'"
            *ngFor="let column of columns">{{column.title | translate}}</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let item of basicTable.data">
        <td class="table-td" *ngFor="let column of columns" [class.numeric]="column.type === 'numeric'">
          {{ column.valueFormatter ? column.valueFormatter(item, column) : item[column.key] }}
        </td>
      </tr>
      </tbody>
    </nz-table>
  </div>
</div>


<nz-drawer
  [nzBodyStyle]="{ overflow: 'auto' }"
  [nzMaskStyle]="{ backgroundColor: '#0000006e' }"
  [nzMaskClosable]="true"
  [nzWidth]="500"
  [nzVisible]="drawerTransaction"
  [nzTitle]="'CREAR TRANSACCION'"
  (nzOnClose)="closeDrawer('drawerTransaction')"
>
  <div class="drawer-transaction">
    <ng-container *ngIf="formTransaction">
      <form [formGroup]="formTransaction">
        <nz-divider class="title" [nzText]="'Origen'" nzOrientation="left"></nz-divider>
        <nz-select nzPlaceHolder="Seleccione un origen" formControlName="originObject">
          <nz-option [nzLabel]="'Consorcio'" [nzValue]="originObjectEnum.Consortium"></nz-option>
          <nz-option [nzLabel]="'Banca'" [nzValue]="originObjectEnum.Banking"></nz-option>
        </nz-select>
        <ng-container *ngIf="formTransaction.value.originObject === originObjectEnum.Consortium">
          <nz-select nzPlaceHolder="Seleccione un consorcio" formControlName="originId">
            <nz-option *ngFor="let consortium of consortiums"
                       [nzLabel]="consortium.name"
                       [nzValue]="consortium._id"></nz-option>
          </nz-select>
        </ng-container>
        <ng-container *ngIf="formTransaction.value.originObject === originObjectEnum.Banking">
          <nz-select nzPlaceHolder="Seleccione una banca" formControlName="originId">
            <nz-option *ngFor="let banking of bankings"
                       [nzLabel]="banking.name"
                       [nzValue]="banking._id"></nz-option>
          </nz-select>
        </ng-container>
        <nz-divider class="title" [nzText]="'Destino'" nzOrientation="left"></nz-divider>
        <nz-select nzPlaceHolder="Seleccione un destino" formControlName="destinationObject">
          <nz-option [nzLabel]="'Consorcio'" [nzValue]="originObjectEnum.Consortium"></nz-option>
          <nz-option [nzLabel]="'Banca'" [nzValue]="originObjectEnum.Banking"></nz-option>
        </nz-select>
        <ng-container *ngIf="formTransaction.value.destinationObject === originObjectEnum.Consortium">
          <nz-select nzPlaceHolder="Seleccione un consorcio" formControlName="destinationId">
            <nz-option *ngFor="let consortium of consortiums"
                       [nzLabel]="consortium.name"
                       [nzValue]="consortium._id"></nz-option>
          </nz-select>
        </ng-container>
        <ng-container *ngIf="formTransaction.value.destinationObject === originObjectEnum.Banking">
          <nz-select nzPlaceHolder="Seleccione una banca" formControlName="destinationId">
            <nz-option *ngFor="let banking of bankings"
                       [nzLabel]="banking.name"
                       [nzValue]="banking._id"></nz-option>
          </nz-select>
        </ng-container>


        <nz-input-number style="margin-bottom: 10px; width: 100%" formControlName="amount" [nzMin]="0"></nz-input-number>

      </form>

      <button nz-button [nzLoading]="loading" [disabled]="formTransaction && !formTransaction.valid || loading" (click)="onClickAccept()">{{'Aceptar'|translate}}</button>
    </ng-container>
  </div>
</nz-drawer>
